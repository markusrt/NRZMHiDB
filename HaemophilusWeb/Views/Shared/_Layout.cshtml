@using System.Configuration
@using System.Diagnostics.Eventing.Reader
@using System.IdentityModel.Protocols.WSTrust
@using System.Reflection
@using System.Threading
@using HaemophilusWeb.Controllers
@using HaemophilusWeb.Models
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Haemophilus Web - @ViewBag.Title</title>
    @Styles.Render("~/Content/css")
    @Scripts.Render("~/bundles/modernizr")
    @Scripts.Render("~/bundles/jquery")
    @Scripts.Render("~/bundles/jquerydatatable")
    @Scripts.Render("~/bundles/bootstrap")

    @Scripts.Render("~/bundles/site")
    @*<link rel="stylesheet" type="text/css" href="https://stackpath.bootstrapcdn.com/bootswatch/4.4.1/sketchy/bootstrap.min.css" media="screen" />*@
    @*<link rel="stylesheet" type="text/css" href="https://stackpath.bootstrapcdn.com/bootswatch/4.4.1/spacelab/bootstrap.min.css" media="screen" />*@
    @*<link rel="stylesheet" type="text/css" href="https://stackpath.bootstrapcdn.com/bootswatch/4.4.1/materia/bootstrap.min.css" media="screen" />*@
    @*<link rel="stylesheet" type="text/css" href="https://stackpath.bootstrapcdn.com/bootswatch/4.4.1/cerulean/bootstrap.min.css" media="screen" />*@
</head>
<body>
    <nav class="navbar navbar-expand-md navbar-dark fixed-top bg-dark">
        <a class="navbar-brand" href="@Url.Action("Index", "Home")">
            <img src="/Images/logo4.png" width="30" height="30" class="d-inline-block align-top" alt="">
            NRZMHi
        </a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarCollapse">
            @if (Request.IsAuthenticated)
            {
                <ul class="navbar-nav mr-auto">
                    @if (User.IsInRole(DefaultRoles.User) || User.IsInRole(DefaultRoles.Administrator))
                    {
                        <li class="nav-item">@Html.ActionLink("Einsender", "Index", "Sender", null, new {@class = "nav-link"})</li>
                        <li class="nav-item">@Html.ActionLink("Haemophilus", "Index", "PatientSending", null, new {@class = "nav-link"})</li>
                        <li class="nav-item">@Html.ActionLink("Meningokokken", "Index", "MeningoPatientSending", null, new {@class = "nav-link"})</li>

                        <li class="nav-item dropdown">
                            <a href="#" class="nav-link dropdown-toggle" id="navbarDropdownExport" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Export <span class="caret"></span></a>
                            <div class="dropdown-menu" aria-labelledby="navbarDropdownExport">
                                @Html.ActionLink("RKI Export (Haemophilus)", "RkiExport", "PatientSending", null, new { @class = "dropdown-item" })
                                @Html.ActionLink("Labor Export (Haemophilus)", "LaboratoryExport", "PatientSending", null, new { @class = "dropdown-item" })
				@Html.ActionLink("Labor Export (Meningokokken)", "LaboratoryExport", "MeningoPatientSending", null, new { @class = "dropdown-item" })
                                @Html.ActionLink("Einsender Export", "Export", "Sender", null, new { @class = "dropdown-item" })
                            </div>
                        </li>
			<li class="nav-item dropdown">
			    <a href="#"  class="nav-link dropdown-toggle" id="navbarDropdownPubMLST" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">PubMLST <span class="caret"></span></a>
                            <div class="dropdown-menu" aria-labelledby="navbarDropdownAdmin">
                                @Html.ActionLink("Matching (Meningokokken)", "PubMlstMatch", "MeningoIsolate", null, new { @class = "dropdown-item" })
			    </div>
                        </li>
                        <li class="nav-item dropdown">
                            <a href="#"  class="nav-link dropdown-toggle" id="navbarDropdownAdmin" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Administration <span class="caret"></span></a>
                            <div class="dropdown-menu" aria-labelledby="navbarDropdownAdmin">
                                @Html.ActionLink("Gelöschte Einsender", "Deleted", "Sender", null, new { @class = "dropdown-item" })
                                @Html.ActionLink("Gelöschte Einsendungen (Haemophilus)", "Deleted", "PatientSending", null, new { @class = "dropdown-item" })
                                @Html.ActionLink("EUCAST Grenzwerte", "Index", "EucastClinicalBreakpoints", null, new { @class = "dropdown-item" })
                                @Html.ActionLink("Gesundheitsämter", "Index", "HealthOffices", null, new { @class = "dropdown-item" })
                            </div>
                        </li>
                    }
                    else if (User.IsInRole(DefaultRoles.PublicHealth))
                    {
                        <li class="nav-item">@Html.ActionLink("RKI Export", "RkiExport", "PatientSending", null, new { @class = "nav-link" })</li>
                    }
                </ul>
            }
            @Html.Partial("_LoginPartial")
        </div>
    </nav>

    <main role="main" class="container">
        <div class="mb-5 mt-4 mb-2 border-bottom">
            <h1>
                @ViewBag.Title
                    @if (!String.IsNullOrEmpty(ViewBag.Subtitle))
                    {
                        <small>@Html.Raw(ViewBag.Subtitle)</small>
                    }
                </h1>
        </div>
        <div id="errorMessages">
            @if ("true".Equals(ConfigurationManager.AppSettings["Beta"]))
            {
                <div class="alert alert-danger">
                    <strong>Achtung: Änderungen werden nicht zentral gespeichert!</strong>
                    Diese Software-Version ist nur eine Demonstrations künftiger Funktionen.
                    Bitte nutzen Sie die <a href="http://db.hygiene.uni-wuerzburg.de/Haemophilus">reguläre Version</a> für den produktiven Einsatz!
                </div>
            }
        </div>

        @if (IsSectionDefined("CreateModel") || IsSectionDefined("EditModel") || IsSectionDefined("DeleteModel"))
        {
            using (Html.BeginForm())
            {
                @Html.AntiForgeryToken()

                <div class="form-horizontal">

                    @Html.ValidationSummary(true)

                    @if (IsSectionDefined("CreateModel"))
                    {
                        @RenderSection("CreateModel")
                        @Html.Partial("_CreateButton")
                    }
                    @if (IsSectionDefined("EditModel"))
                    {
                        @RenderSection("EditModel")
                        @Html.Partial("_EditButton")
                    }
                    @if (IsSectionDefined("DeleteModel"))
                    {
                        @RenderSection("DeleteModel")
                        @Html.Partial("_DeleteButton")
                    }
                </div>
            }
        }

        @RenderBody()
        <hr/>
        <footer>
            <p>
                &copy; @DateTime.Now.Year
                - Referenzzentrum für Meningokokken und <i>H. influenzae</i> (NRZMHi), Inst. für Hygiene und Mikrobiologie, Würzburg, Deutschland
                - Version: @Assembly.GetAssembly(typeof(HomeController)).GetName().Version
            </p>
        </footer>
    </main>


    <script>
        $(document).ready(function() {
            $(".datepicker").datetimepicker(
                {
                    format: "DD.MM.YYYY",
                    pickTime: false,
                    language: "de",
                });
            $(".datetimepicker").datetimepicker(
                {
                    format: "DD.MM.YYYY HH:mm",
                    language: "de",
                });
            Globalize.culture("de-DE");

            var errorMessage = '@TempData["ErrorMessage"]';
            if (errorMessage.length > 0) {
                ShowError(errorMessage);
            }

            var warningMessage = '@TempData["WarningMessage"]';
            if (warningMessage.length > 0) {
                ShowWarning(warningMessage);
            }

            // Support for formatted date sorting in datatables
            $.fn.dataTable.moment('DD.MM.YYYY');
        });
    </script>

    @RenderSection("scripts", false)

    @Scripts.Render("~/bundles/jqueryval")
    @Scripts.Render("~/bundles/globalize-de-DE")
    @Scripts.Render("~/bundles/globalized-validation")
</body>
</html>