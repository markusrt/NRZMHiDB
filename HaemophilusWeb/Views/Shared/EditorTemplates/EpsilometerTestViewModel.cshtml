@using HaemophilusWeb.Models
@using HaemophilusWeb.Views.Utils
@model HaemophilusWeb.ViewModels.EpsilometerTestViewModel

@{ 
    var relevantBreakPoints = ((IEnumerable<EucastClinicalBreakpoint>) ViewBag.ClinicalBreakpoints).Where(
        b => b.Antibiotic == Model.Antibiotic).ToList();
}

<div class="col-sm-2 col-xs-3">
    @Html.TextBoxFor(m => m.Measurement, new {@class = "form-control"})
    @Html.ValidationMessageFor(m => m.Measurement)
</div>
<div class="col-sm-4 col-xs-7">
    @Html.DropDownListFor(model => model.EucastClinicalBreakpointId, relevantBreakPoints.Select(
        option => new SelectListItem
        {
            Text = string.Format("{0} - v{1} vom {2:dd. MMM. yy}", option.AntibioticDetails, option.Version, option.ValidFrom),
            Value = option.EucastClinicalBreakpointId.ToString(),
            Selected = (Model != null) && (option.EucastClinicalBreakpointId == Model.EucastClinicalBreakpointId)
        }), "EUCAST Breakpoint auswählen...", new {@class = "form-control"})
    @Html.ValidationMessageFor(m => m.EucastClinicalBreakpointId)
</div>
<div class="col-sm-4 col-xs-2">
    <span id="@(Model.Antibiotic + "_ETestSusceptible")" class="label label-etest-Susceptible @(Model.Result==EpsilometerTestResult.Susceptible?"":"hidden")">
        @EnumEditor.GetEnumDescription(EpsilometerTestResult.Susceptible)
    </span>
    <span id="@(Model.Antibiotic + "_ETestIntermediate")" class="label label-etest-Intermediate @(Model.Result==EpsilometerTestResult.Intermediate?"":"hidden")">
        @EnumEditor.GetEnumDescription(EpsilometerTestResult.Intermediate)
    </span>
    <span id="@(Model.Antibiotic + "_ETestResistant")" class="label label-etest-Resistant @(Model.Result==EpsilometerTestResult.Resistant?"":"hidden")">
        @EnumEditor.GetEnumDescription(EpsilometerTestResult.Resistant)
    </span>
    @Html.HiddenFor(m => m.Result)
</div>
